language: cpp
os: linux
dist: xenial
sudo: required

before_install:
    - export CXX=clang++
    - export CC=clang

install:
    - sudo apt update
    - sudo apt install libc++1
    - git clone https://github.com/statoil/segyio
    - pushd segyio
    - cmake . -DEXPERIMENTAL=ON -DBUILD_PYTHON=OFF
              -DBUILD_TESTING=OFF -DBUILD_SHARED_LIBS=OFF
              -DCMAKE_CXX_FLAGS=-stdlib=libc++
    - make
    - sudo make install
    - popd

script:
    - mkdir build
    - pushd build
    - cmake .. -DCMAKE_BUILD_TYPE=Release
               -DCMAKE_CXX_FLAGS=-stdlib=libc++
    - make
    - make test
